<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sign Up</title>
    <!-- Include Bootstrap CSS for styling and modal functionality -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
	
	<style>
	body {
    margin: 0;
    font-family: 'Arial', sans-serif;
}

.navbar {
    background-color: #176B87; /* Dark shade for navbar */
    color: #fff;
    padding: 10px 20px;
    display: flex;
    justify-content: space-between; /* Aligns content on opposite ends */
    align-items: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
	border-radius: 5px;
}

.navbar-content {
    display: flex;
    align-items: center;
}

.page-name {
    font-size: 1.5rem;
    font-weight: 500;
    margin-right: 20px; /* Space between page name and user info */
}

.user-info {
    display: flex;
    align-items: center;
}

.user-name {
    font-size: 1rem;
    margin-right: 10px;
}

.user-avatar {
    width: 40px; /* Adjust size as necessary */
    height: 40px;
    border-radius: 50%; /* Circular avatar */
    border: 2px solid #fff; /* White border for contrast */
}



        #sidebar {
    width: 250px;
    background: linear-gradient(165deg, #145B77 30%, #176B87 100%); /* Subtle gradient */
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    padding-top: 20px;
    box-shadow: 5px 0 15px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
    z-index: 1000; /* Ensure sidebar is always on top */
}

#sidebar #logo {
    text-align: center;
    margin-bottom: 20px;
}

#sidebar #logo img {
    width: 100px; /* Slightly larger logo */
    height: 100px;
    border-radius: 50%; /* Perfect circle */
    margin-bottom: 10px;
}

#sidebar #logo h1 {
    color: #fff;
    font-size: 24px; /* Adjusted for better visibility */
    font-weight: bold;
}

#sidebar ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#sidebar ul li {
    position: relative;
    padding: 10px 20px;
    text-align: left;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px; /* Rounded edges */
    transition: background-color 0.3s ease; /* Smooth transition */
}

#sidebar ul li a {
    color: #fff;
    text-decoration: none;
    display: flex; /* Aligns icons and text */
    align-items: center; /* Centers items vertically */
}

#sidebar ul li a i { /* Icon styling */
    margin-right: 10px; /* Space between icon and text */
    font-size: 18px; /* Icon size */
}

#sidebar ul li.active, #sidebar ul li:hover { /* Active/Hover state */
    background-color: #ddf1ff; 
    color: #176B87; /* Adjust as needed */
}

#sidebar ul li.active a, #sidebar ul li:hover a { /* Active/Hover link state */
    color: #176B87; /* Adjust as needed */
}


         #content {
            margin-left: 260px;
            padding: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            border-radius: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #C7E0F4;
            color: #000;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .actions {
            text-align: center;
        }
        .remove-link {
            color: red;
            cursor: pointer;
        }
		

.overlay-style {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1;
}

.popup-style {
  display: flex; /* Initially hidden; you'll make it visible in the JS */
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #fff;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
  z-index: 2;
  font-size: 16px;
  display: flex;
  flex-direction: column;
  width: 50%; /* Adjust width as needed */
  max-width: 550px; /* Adjust max-width as needed */
}

#popup select:last-of-type,
#popup input:last-of-type {
  margin-bottom: 30px; /* Adjust this value to create more space */
}

.button-container {
  display: flex;
  justify-content: flex-end; /* Align buttons to the right */
  gap: 20px; /* Space between buttons */
}

.btn {
  padding: 10px 20px; /* Button padding */
  border: none; /* No border */
  border-radius: 5px; /* Rounded borders */
  cursor: pointer; /* Pointer cursor on hover */
}

.btn-save {
  background-color: #176B87;
  color: white;
}

.btn-cancel {
  background-color: #176B87; /* Cancel button color */
  color: white;
}

.btn-save:hover,
.btn-cancel:hover {
  opacity: 0.8; /* Slight transparency on hover */
}

/* Existing body and container styles... */

.custom-card {
    border: none;
    overflow: hidden;
}

.search-container {
    flex-grow: 1;
    max-width: 400px;
    margin-right: 30px;
}

.rounded-input {
    border-radius: 30px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.rounded-button {
    border-radius: 20px;
    background: linear-gradient(45deg, #176B87, #2091B9);
    color: #fff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.custom-table {
    background-color: #fff;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    border-collapse: separate;
    border-spacing: 0 15px; /* Adds space between rows */
}

.custom-table th {
    background-color: #176B87;
    color: #FFFFFF;
    padding: 15px;
    text-align: left;
    font-weight: normal; /* For a lighter header look */
}

.custom-table td {
    padding: 15px;
    background-color: #FAFAFA; /* Light background for rows */
    border-bottom: 1px solid #ECECEC; /* Subtle border for separation */
}

.custom-table tr:hover {
    background-color: #f2f2f2; /* Slight color change on hover */
    cursor: pointer; /* Change cursor to indicate interactiveness */
}
		</style>
</head>
<body>
    <div id="sidebar">
    <div id="logo">
        <img src="sir al min school.png" alt="Sir Al Min School Logo">
        <h1>TURQUOISE</h1>
    </div>
    <ul>
        <li><a href="landingpage.html"><i class="fa fa-home"></i> Landing page</a></li>
        <li><a href="teacher.html"><i class="fa fa-user"></i> Teachers List</a></li>
        <li><a href="view.html"><i class="fa fa-users"></i> Students List</a></li>
		<li><a href="user.html"><i class="fa fa-users"></i> User List</a></li>
    </ul>
</div>
    <div id="content">
        <nav class="navbar">
    <div class="navbar-content">
        <span class="page-name">User List</span> <!-- Dynamic current page name -->
        
    </div>
</nav>

<div class="container mt-4">
    <div class="card rounded-lg shadow-lg custom-card"> <!-- Enhanced shadow and overflow -->
        <div class="card-body">
            <!-- Search and Add button -->
            <div class="d-flex justify-content-between mb-4">
                <div class="search-container">
                    <input type="text" id="searchInput" class="form-control rounded-input" placeholder="Search User" > <!-- Input shadow -->
                </div>
                <button id="addTeacherButton" class="btn btn-primary rounded-button"  data-toggle="modal" data-target="#addUserModal">Add User</button> <!-- Gradient button -->
            </div>
            
            <!-- Modern Table -->
<div class="table-responsive">
    <table id="teacherTable" class="table custom-table">
        <thead>
            <tr>
			    <th>ID</th>
                <th>Email Address</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="usersList">
            <!-- User data will be inserted here by the script -->
        </tbody>
    </table>
</div>
        </div>
    </div>
</div>
    

    <!-- Add User Modal -->
    <div class="modal fade" id="addUserModal" tabindex="-1" role="dialog" aria-labelledby="addUserModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addUserModalLabel">Add User</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <!-- Form to Add User -->
            <form id="signup-form">
              <div class="form-group">
                <label for="user-email">Email</label>
                <input type="email" class="form-control" id="user-email" required>
              </div>
              <div class="form-group">
                <label for="user-password">Password</label>
                <input type="password" class="form-control" id="user-password" required>
              </div>
              <button type="submit" class="btn btn-primary rounded-button">Sign Up</button>
              <div id="signup-error" class="text-danger mt-2" style="display: none;"></div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


<script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
      import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";


      //  web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyA8vydj3oJu9g90W7jVKyjY7NQzvtUUTko",
        authDomain: "turquoise-9d090.firebaseapp.com",
        databaseURL: "https://turquoise-9d090-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "turquoise-9d090",
        storageBucket: "turquoise-9d090.appspot.com",
        messagingSenderId: "942530582497",
        appId: "1:942530582497:web:67204c20d2ebdb7a3d64a0",
        measurementId: "G-0RE20PDVEN"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
	  
	  
document.getElementById('signup-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const email = document.getElementById('user-email').value;
  const password = document.getElementById('user-password').value;
  const errorDiv = document.getElementById('signup-error');

  try {
    // Assume createUserWithEmailAndPassword is correctly implemented to create a new user
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    console.log('User created:', userCredential.user);

    // Update UI: Add user to the list
    createUserRow(userCredential.user);

    // Clear form fields
    e.target.reset();
    // Optionally, close the modal
    $('#addUserModal').modal('hide');

  } catch (error) {
    console.error('Error signing up:', error.message);
    errorDiv.textContent = error.message;
    errorDiv.style.display = 'block';
  }
});


function createUserRow(user) {
  const usersList = document.getElementById('usersList');
  const tr = document.createElement('tr');
  tr.id = `user-row-${user.uid}`; // Adjust if your ID field has a different name

  // Create and append the ID cell
  const idTd = document.createElement('td');
  idTd.textContent = user.uid; 
  tr.appendChild(idTd);

  // Create and append the email cell
  const emailTd = document.createElement('td');
  emailTd.textContent = user.email; 
  tr.appendChild(emailTd);

  // Create and append the action cell with a delete icon
  const actionTd = document.createElement('td');
  const deleteIcon = document.createElement('i');
  deleteIcon.className = 'fa fa-trash'; 
  deleteIcon.style.cursor = 'pointer';
  deleteIcon.addEventListener('click', function() {
    deleteUser(user.uid); 
  });
  actionTd.appendChild(deleteIcon);
  tr.appendChild(actionTd);

  // Append the row to the table body
  usersList.appendChild(tr);
}

	  
	  async function deleteUser(uid) {
  if (!window.confirm("Are you sure you want to delete this user?")) {
    return;
  }

  // For security reasons, user deletion should be done through a server-side endpoint
   try {
    const response = await fetch(`http://localhost:3000/admin/deleteUser/${uid}`, {
      method: 'DELETE',
      headers: {
        'Content-Type': 'application/json',
		'X-API-Key': 'AIzaSyA8vydj3oJu9g90W7jVKyjY7NQzvtUUTko'
        // Include any necessary authentication headers
      },
    });
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    try {
      // Attempt to parse the response as JSON
      const result = await response.json();
      console.log('Response from server:', result);
    } catch (parseError) {
      // If parsing as JSON fails, read it as text
      console.warn('Response not in JSON format:', await response.text());
    }

    alert('User deleted successfully!');
    // Remove the user's row from the table
    const userRow = document.getElementById(`user-row-${uid}`);
    if (userRow) {
      userRow.remove();
    }
  } catch (error) {
    console.error('Error deleting user:', error);
    // Handle errors appropriately in the UI
  }
}

fetch('http://localhost:3000/users')
  .then((response) => response.json())
  .then((users) => {
    users.forEach((user) => {
      createUserRow(user); // Reuse the function to add each user to the table
    });
  })
  .catch((error) => {
    console.error('Error fetching users:', error);
  });
  
  
  // Get the elements
const input = document.getElementById('searchInput');
const table = document.getElementById('teacherTable');
const rows = table.getElementsByTagName('tr');

// Function to search the table
function searchTable() {
    const searchQuery = input.value.toLowerCase();

    // Loop through all table rows, and hide those who don't match the search query
    for (let i = 1; i < rows.length; i++) { // Start at 1 to skip the header row
        const emailCell = rows[i].getElementsByTagName("td")[1]; // Get the email cell
        if (emailCell) {
            const emailText = emailCell.textContent || emailCell.innerText;
            rows[i].style.display = emailText.toLowerCase().indexOf(searchQuery) > -1 ? "" : "none";
        }
    }
}

// Add event listener for the input field
input.addEventListener('keyup', searchTable);

</script>

</body>
</html>